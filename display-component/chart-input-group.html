<link rel="import" href="chart-input.html"/>
<link rel="import" href="drag-element.html"/>
<link href="../behaviors/redux-mixins-behavior.html" rel='import'>
<dom-module id="chart-input-group">
  <template>
    <style>
    .input-drag-wrapper{
      padding: 1em;
    }
    :host{
        position: relative;
        overflow: hidden;
        background: #2f3238;
        border-bottom: solid 1px #c71503;
        display: block;
        overflow: hidden;
    }
    .input-drag-wrapper{
      padding: 1em;
    }
    #inputItems{
      background: #cc6055;
    }

    </style>

    <!-- <div uuid = [[getUUID]]></div> -->
    <div class="input-drag-wrapper">
      <template is="dom-repeat" items="[[ externals ]]">
        <drag-element item="[[item]]" draggable="true"  data-index$="[[item.value]]"></drag-element>
      </template>
    </div>

    <div id="inputItems">
      <slot name="chart-input"></slot>
    </div>

  </template>
<script>
const initialExt = [{
  key: 'Q1',
  type: 'Number',
  value: 0
}, {
  key: 'Q2',
  type: 'Number',
  value: 1
}, {
  key: 'Q3',
  type: 'Number',
  value: 2
}, {
  key: 'Q4',
  type: 'Number',
  value: 3
}]
    class chartInputGroup extends ReduxMixinBehavior(Polymer.Element) {
        static get is() {
            return 'chart-input-group';
        }
        static get properties(){
          return{
            externals:{
              type:Array,
              value:[]
            },
            source:{
              type:Array,
              value:[]
            },
            inputs:{
              type:Array,
              statePath(state){
                return state.charts[this.uuid]['inputs']
              }
            },
            inputObj:{
              type:Object,
              value:{}
            }
          }
        }
        static get actions() {
          return {
            updateInputs(inputs) {
              return {
                type: 'UPDATE_CHART_INPUTS',
                value: inputs
              };
            }
          }
        }
        constructor() {
            super();
        }
        static get observers(){
          return["_inputChange(inputObj)"]
        }
        connectedCallback(){
          super.connectedCallback()
          this.set("externals", initialExt)

        }
        _inputChange(objData){
          // debugger
          let key = Object.keys( objData )
          if(objData!== undefined && key.length!=0){
            let objKey = Number(key)
            let updatedInput = objData[key]
            this.dispatch("updateInputs", {uuid:this.uuid,objKey:objKey,input:updatedInput})
          }

        }
        _initializeData(){

        }
    }
    customElements.define(chartInputGroup.is, chartInputGroup)
</script>
</dom-module>
