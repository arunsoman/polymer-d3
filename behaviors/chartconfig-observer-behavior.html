<script>
  PolymerD3.chartconfigObserver = {
    observers: ['_settingsWatcher(settings.*)', '_inputsWatcher(inputs.*)', '_sourceWatcher(source.*)'],

    _settingsWatcher: function(settings) {
      // var me = this;
      // // To avoid calling draw on merging and initiation
      // if (settings.path === 'settings.splices' || settings.path === 'settings.length' || settings.path === 'settings') {
      //   return;
      // }
      // this.debounce('redrawSettings', function() {
      //   me.draw();
      // }, 1000);
    },

    _inputsWatcher: function(inputs) {
      var me = this;
      // To avoid calling draw on initation
      if (inputs.path === 'inputs') {
        return;
      }
      this.debounce('redrawInput', function() {
        var chartWrap = me.$$('.chartContainer');
        if (chartWrap) {
          chartWrap.removeChild();
        }
        me._manageDom()

        me.draw();
      }, 1000);
    },

    // Draw when datasource is avialable
    _sourceWatcher: function(source) {
      var me = this;
      if (source.path === 'source') {
        this.debounce('redrawInput', function() {
          me.draw();
        }, 1000);
      }
    },
    addLegend: function(domain){
     // draw legend
      var legend = svg.selectAll(".legend")
        .data(domain)
      //.data(color.domain())
      .enter().append("g")
        .attr("class", "legend")
        .attr("transform", function(d, i) { 
          return "translate(0," + i * 20 + ")"; 
        });

      // draw legend colored rectangles
      legend.append("rect")
        .attr("x", width - 18)
        .attr("width", 18)
        .attr("height", 18)
        .style("fill", color);

      // draw legend text
      legend.append("text")
        .attr("x", width - 24)
        .attr("y", 9)
        .attr("dy", ".35em")
        .style("text-anchor", "end")
        .text(function(d) { 
          return d;
        });
  }
  }
</script>
