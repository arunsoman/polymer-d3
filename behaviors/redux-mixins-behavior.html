<link rel="import" href="../bower_components/polymer-redux/polymer-redux.html">
<script src="../node_modules/redux/dist/redux.js"></script>
<script>

  const initialState = {
      externals:[],
      source:[],
      charts:{}
}

  const appReducer = (state, action) => {
      state = state || initialState
      let chartObj = {
          externals:externalsReducer(state.externals, action),
          source:sourceReducer(state.source, action),
          charts: chartReducer(state.charts, action)
      }
      return chartObj
  }

  const chartReducer = (state, action) =>{
      switch (action.type) {
          case 'ADD_CHART':
              return Object.assign({},state,{[action.value.id]:action.value})
          case 'UPDATE_CHART':
              return Object.assign({},state,{[action.value.id]:action.value})
          case 'ADD_UPDATE_CHART_INPUTS':
            return  Object.assign({},state,{[action.value.uuid]:Object.assign({},
              state[action.value.uuid],{
                inputs:Object.assign({},state[action.value.uuid].inputs,{
                  [action.value.objKey]:action.value.input
                })
              })})
          default:
              return state;
      }
  }

  const externalsReducer =(state, action)=>{
    switch(action.type){
      case"UPDATE_EXTERNALS":
        return state.concat(action.value)
      default:
          return state;
    }
  }
  const sourceReducer =(state, action)=>{
    switch(action.type){
      case"UPDATE_SOURCE":
        return state.concat(action.value)
      default:
          return state;
    }
  }


  // const store = Redux.createStore(appReducer)

  const store = Redux.createStore(  appReducer,  initialState,
    Redux.compose(window.devToolsExtension ? window.devToolsExtension() : v => v)
  );

  ReduxMixinBehavior = PolymerRedux(store)

</script>
