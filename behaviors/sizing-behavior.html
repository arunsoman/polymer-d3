<script>
  PolymerD3.sizingBehavior = {
    properties: {
      area: {
        type: Array,
        value: [{
                input: 'height',
                txt: 'Height of the chart',
                uitype: 'Number',
                selectedValue: 500
            }, {
                input: 'width',
                txt: 'Width of the chart',
                uitype: 'Number',
                selectedValue: 960
            }, {
                input: 'marginTop',
                txt: 'Top  margin',
                uitype: 'Number',
                selectedValue: 40
            }, {
                input: 'marginRight',
                txt: 'Right margin',
                uitype: 'Number',
                selectedValue: 10
            }, {
                input: 'marginBottom',
                txt: 'Bottom margin',
                uitype: 'Number',
                selectedValue: 20
            }, {
                input: 'marginLeft',
                txt: 'Left margin',
                uitype: 'Number',
                selectedValue: 10
            }]
        }
    },
    observers: ['_areaChanged(area)'],
    
    _areaChanged:function(area)}{
        this._widthChanged();
        this._heightChanged();
        this.draw();
    },
    attached: function() {
        var me = this;
        this.async(function() {
            PolymerD3.utilities.merge.apply(me, ['settings', 'area']);
        });
    },
    getMargins: function() {
        return {
            top: this.getSettingsProperty('marginTop'),
            right: this.getSettingsProperty('marginRight'),
            bottom: this.getSettingsProperty('marginBottom'),
            left: this.getSettingsProperty('marginLeft')
        }
    },
    registerHeightChange: function(scale, invert, scaleType){
        if(!this.heightScales)
            this.heightScales = [];
        this.heightScales.push([scale, invert, scaleType]);
    },
    registerWidthChange: function(scale, invert, scaleType){
        if(!this.widthScales)
            this.widthScales = [];
        this.widthScales.push([scale, invert, scaleType]);
    },
    _computeHeight: function(){
        var margin = this.getMargins();
        return this.getHeight() - margin.top - margin.bottom;
    },
    _computeWidth: function(){
        var margin = this.getMargins();
        return this.getWidth() - margin.left - margin.right;
    }
    _heightChanged: function(){
        if(this.heightScales){
            var height = _computeHeight();
            this.heightScales.forEach(function(aScale){
                switch(aScale[2]){
                case 'time':
                case 'linear':
                    aScale[0].range(aScale[1]?[height,0]:[0,height]);
                    break;
                case 'category':
                    aScale[0].rangeRoundBands(aScale[1]?[height,0]:[0,height]);
                    break;
                }
            });
        }
    },
    _widthChanged: function(){
        if(this.widthScales){
            var width = _computeWidth();
            this.widthScales.forEach(function(aScale){
                aScale[0].range(aScale[1]?[0, width]:[width,0]);
            });
        }
    }
  }
</script>