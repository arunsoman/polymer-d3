<script>
  PolymerD3.sizingBehavior = {
    properties: {
        area: {
            type: Array
        }
    },
    observers: ['_areaChanged(settings.area.*)'],

    ready: function() {
        this.area = [
            {
                input: 'height',
                txt: 'Height of the chart',
                uitype: 'Number',
                selectedValue: 500
            }, {
                input: 'width',
                txt: 'Width of the chart',
                uitype: 'Number',
                selectedValue: 960
            }, {
                input: 'marginTop',
                txt: 'Top  margin',
                uitype: 'Number',
                selectedValue: 40
            }, {
                input: 'marginRight',
                txt: 'Right margin',
                uitype: 'Number',
                selectedValue: 10
            }, {
                input: 'marginBottom',
                txt: 'Bottom margin',
                uitype: 'Number',
                selectedValue: 20
            }, {
                input: 'marginLeft',
                txt: 'Left margin',
                uitype: 'Number',
                selectedValue: 50
            }
        ];
    },

    attached: function() {
        var unit = [1];
        var outerWidth = this._getWidth();
        var outerHeight = this._getHeight();
        var margin = this.getMargins();
        this.chartWidth  = outerWidth  - margin.left - margin.right;
        this.chartHeight = outerHeight - margin.top  - margin.bottom;
      
        var chartContainer = this.querySelector('.chartContainer');
        var d3CharContainer = d3.select(chartContainer);
        var svg = d3.select(d3CharContainer).data(unit);
        svg.enter().append("svg")
            .attr("width",  outerWidth)
            .attr("height", outerHeight)
            .attr("class", "chartSvgClass");
        
        svg.attr("width",  outerWidth)
            .attr("height", outerHeight);

        svg.exit().remove();

        this. parentG = svg.append("g")
            .attr("class" , "parentGClass")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
    },

    _areaChanged:function(area){
        var me = this;
        var unit = [1];
        var outerWidth = this._getWidth();
        var outerHeight = this._getHeight();
        var margin = this.getMargins();
        this.chartWidth  = outerWidth  - margin.left - margin.right;
        this.chartHeight = outerHeight - margin.top  - margin.bottom;
      
        var svg = d3.select(this.querySelector('.chartSvgClass')).data[unit];
        svg.enter().append("svg")
            .attr("width",  outerWidth)
            .attr("height", outerHeight)
            .attr("preserveAspectRatio", "xMinYMin meet")
            .attr("viewBox", "0 0 " + chartWidth +" " + chartHeight +"")
            .attr("class", "chartSvgClass");
        
        svg.attr("width",  outerWidth)
            .attr("height", outerHeight);

        svg.exit().remove();

        this.parentG =  d3.select(this.querySelector('.chartSvgClass')).data(unit);
        this. parentG = svg.append("g")
            .attr("class" , "parentGClass")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        
        this.parentG.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        
        this.parentG.exit.remove();
},

    _getHeight: function() {
        return parseInt(this.area[0]['selectedValue']);
    },
    _getWidth: function() {
        return parseInt(this.area[1]['selectedValue']);
    },
    alignAxis: function(axis, alignment) {
        var height = this._getHeight();
        var width = this._getWidth();
        var margin = this.getMargins();
        switch(alignment) {
            case 'top':
                this.svg.select('g')
                    .append('g')
                    .attr('class', 'axis axis--' + alignment)
                    .call(axis);
                break;
            case 'bottom':
                debugger;
                this.svg.select('g')
                    .append('g')
                    .attr('class', 'axis axis--' + alignment)
                    .attr('transform', 'translate(0,' + (height - (margin.top + margin.bottom)) + ')')
                    .call(axis);
                break;
            case 'left':
                this.svg.select('g')
                    .append('g')
                    .attr('class', 'axis axis--' + alignment)
                    .call(axis);
                break;
            case 'right':
                this.svg
                    .select('g').append('g')
                    .attr('class', 'axis axis--' + alignment)
                    .attr('transform', 'translate(0,' + (width - (margin.left + margin.right)) + ')')
                    .call(axis);
                break;
        }
    },
    getMargins: function() {
        return {
            top: parseInt(this.area[2]['selectedValue']),
            right: parseInt(this.area[3]['selectedValue']),
            bottom: parseInt(this.area[4]['selectedValue']),
            left: parseInt(this.area[5]['selectedValue'])
        }
    }
  }
</script>