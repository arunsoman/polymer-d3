<link rel="import" href="polymer-d3-imports.html">
<link href="behaviors/redux-mixins-behavior.html" rel='import'>

<dom-module id="polymer-d3">
<template>
  <chart-holder settings-visible></chart-holder>
</template>
<!-- <script src="data.js"></script> -->
<script>
  class polymerD3 extends Polymer.mixinBehaviors([],ReduxMixinBehavior(Polymer.Element)) {
    static get is(){return 'polymer-d3'}
    static get properties(){
      return{
        source:{
          type:Object,
          observer:'addStore'
        }
      }
    }
     
  static get actions() {
    return {
      updateExternal(externals) {
        return {
          type: 'UPDATE_EXTERNALS',
          value: externals
        };
      },      
      updateSource(source) {
        return {
          type: 'UPDATE_SOURCE',
          value: source
        };
      }
    }
  }
  /*
  add data to redux store, so that all available chart can subscribe to this data.
  */
  addStore(){
    if(this.source!==undefined){
      this.dispatch("updateSource",this.source.source)
      this.dispatch("updateExternal",this.source.externals)
    }
  }
  constructor(){
    super();
    
  }

  // Bootstraps element as per mode(view/edit)
  // This meathod avoids crazy rwo-way binding side effects
  bootstrapCharts(config) {
    this.set('editMode', true);
  }
}

window.customElements.define(polymerD3.is,polymerD3)

</script>
</dom-module>
